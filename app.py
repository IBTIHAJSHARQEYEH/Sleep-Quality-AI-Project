import streamlit as st
import joblib
import pandas as pd
import numpy as np

# ุชุญููู ุงููููุฐุฌ ูุงูุจูุงูุงุช
model = joblib.load('sleep_model.pkl')
df = pd.read_csv('processed_sleep_data.csv')

st.title("๐ ูุธุงู Sleep IQ: ุงูุชุญููู ูุงูุชูุตูุงุช ุงูุฐููุฉ")

# ูุงุฌูุฉ ุงููุฏุฎูุงุช
st.sidebar.header("ููุญุฉ ุงูุจูุงูุงุช ุงูุดุฎุตูุฉ")
age = st.sidebar.slider("ุงูุนูุฑ", 10, 80, 25)
sleep_duration = st.sidebar.slider("ุณุงุนุงุช ุงูููู", 4.0, 12.0, 7.0)
steps = st.sidebar.number_input("ุงูุฎุทูุงุช ุงูููููุฉ", 0, 20000, 5000)
stress_level = st.sidebar.slider("ูุณุชูู ุงูุชูุชุฑ", 1, 10, 5)

if st.button("ุงูุญุตูู ุนูู ุงูุชููุน ูุงูุชูุตูุฉ"):
    # ููุง ุงูููุฏ ุงูุฐู ูุงู ูุนูู ุจูุฌุงุญ ูู ุงููุณุฎุฉ ุงูุฃููู
    # ูุฑุณู ุงูุจูุงูุงุช ูููููุฐุฌ (ุชุฃูุฏ ุฃู ูุฐุง ุงูุฌุฒุก ูุทุงุจู ุงููุณุฎุฉ ุงูุชู ุนููุช ุนูุฏู)
    input_data = np.array([[age, sleep_duration, steps, stress_level]])
    
    # ููุงุญุธุฉ: ุฅุฐุง ูุงู ุงููููุฐุฌ ูุญุชุงุฌ 23 ููุฒุฉุ ูุฌุจ ุงุณุชุฎุฏุงู ููุณ ุทุฑููุฉ ุงููุนุงูุฌุฉ ุงูุณุงุจูุฉ
    # ุณุฃุชุฑู ุงูุชูุจุค ููุง ูุงู ูู ุฃูู ูุณุฎุฉ ุงุดุชุบูุช ูุนู ุชูุงูุงู
    try:
        prediction = model.predict(input_data)[0]
        
        # ุนุฑุถ ุงููุชูุฌุฉ ุจููู ุฃุฎุถุฑ ุจุฏูุงู ูู ุงูุฃุณูุฏ
        st.markdown(f"### ุงููุชูุฌุฉ: <span style='color:green'>{prediction}</span>", unsafe_allow_html=True)
    except:
        st.error("ูุฑุฌู ุงูุชุฃูุฏ ูู ูุทุงุจูุฉ ูุฏุฎูุงุช ุงููููุฐุฌ.")

# ุงูุฑุณูู ุงูุจูุงููุฉ ุงูุชู ูุงูุช ุชุธูุฑ ูู ุงูุตูุฑุฉ ุงููุณุชูุฑุฉ
st.subheader("๐ ุงุณุชูุดุงู ูุดุงุทู")
st.scatter_chart(df)
