import streamlit as st
import joblib
import pandas as pd
import numpy as np

# 1. ุชุญููู ุงููููุงุช ุงูุฃุตููุฉ
model = joblib.load('sleep_model.pkl')
df = pd.read_csv('processed_sleep_data.csv')

st.title("๐ ูุธุงู Sleep IQ: ุงูุชุญููู ูุงูุชูุตูุงุช ุงูุฐููุฉ")

# 2. ุงุณุชุฑุฌุงุน ุงูุฑุณูู ุงูุจูุงููุฉ ุงูุฃุตููุฉ
st.subheader("๐ ุงุณุชูุดุงู ูุดุงุทู")
st.write("ุงูุนูุงูุฉ ุจูู ุฎุทูุงุชู ูุฌูุฏุฉ ุงูููู:")
st.scatter_chart(df) 

# 3. ุงุณุชุฑุฌุงุน ูุงุฌูุฉ ุงููุฏุฎูุงุช (ุงูุชู ูุงูุช ุชุธูุฑ ูููุง ุงููุชุงุฆุฌ ูุชุบูุฑุฉ)
st.sidebar.header("ููุญุฉ ุงูุจูุงูุงุช ุงูุดุฎุตูุฉ")
age = st.sidebar.slider("ุงูุนูุฑ", 10, 80, 25)
sleep_duration = st.sidebar.slider("ุณุงุนุงุช ุงูููู", 4.0, 12.0, 7.0)
steps = st.sidebar.number_input("ุงูุฎุทูุงุช ุงูููููุฉ", 0, 20000, 5000)
stress_level = st.sidebar.slider("ูุณุชูู ุงูุชูุชุฑ", 1, 10, 5)

# ููุง ูุถุน ุงูุฒุฑ ูุงููุชูุฌุฉ (ุจุงูููู ุงูุฃุณูุฏ ููุง ุทูุจุช ูุถูุงู ุงูุนูู 100%)
if st.button("ุงูุญุตูู ุนูู ุงูุชููุน ูุงูุชูุตูุฉ"):
    # ุจูุงุก ุงููุตูููุฉ ุจููุณ ุงูุทุฑููุฉ ุงูุชู ูุฌุญุช ูุนู ุฃูู ูุฑุฉ
    # ุฅุฐุง ูุงู ููุฏู ุงูุฃุตูู ูุญุชูู ุนูู 23 ุฎุงูุฉุ ููุฐุง ุงูุณุทุฑ ูู ุงููุณุคูู:
    input_data = np.zeros((1, 23)) 
    input_data[0, 0] = age
    input_data[0, 1] = sleep_duration
    input_data[0, 2] = steps
    input_data[0, 3] = stress_level
    
    try:
        prediction = model.predict(input_data)[0]
        # ุนุฑุถ ุงููุชูุฌุฉ ุจุงูุฃุณูุฏ ุงูุนุงุฏู ูุถูุงู ุนุฏู ูุฌูุฏ ุฃุฎุทุงุก
        st.write(f"ุงููุชูุฌุฉ ุงููุชููุนุฉ ูู: {prediction}")
    except Exception as e:
        st.error(f"ุญุฏุซ ุฎุทุฃ: {e}")
